Docker - среда для управления контейнерами

Docker — это приложение, упрощающее процесс управления процессами приложения в контейнерах. Контейнеры позволяют запускать приложения в процессах с изолированными ресурсами. Они похожи на виртуальные машины, но более портативные, более эффективно расходуют ресурсы и в большей степени зависят от операционной системы хоста.

================================================
Сервер ubuntu

ssh mylitvinov@192.168.1.182

==========================================

проверка версии docker

docker version 

========================================

sudo systemctl status docker

=========================================
Добавляем user в группу docker

sudo usermod -aG docker mylitvinov

==============================================

Использование docker подразумевает передачу ему цепочки опций и команд, за которыми следуют аргументы. Синтаксис имеет следующую форму:

docker [option] [command] [arguments]

=========================================================

Чтобы просмотреть параметры, доступные для конкретной команды, введите:

docker docker-subcommand --help
 
Чтобы просмотреть общесистемную информацию о Docker, введите следующее:

docker info
===============================================================

Чтобы проверить, можно ли получить доступ к образам из Docker Hub и загрузить их, введите следующую команду:

docker run hello-world

==========================================================

Вы можете выполнять поиск доступных на Docker Hub с помощью команды docker с субкомандой search. Например, чтобы найти образ Ubuntu, введите:

docker search ubuntu

============================================================

Запустите следующую команду, чтобы загрузить официальный образ ubuntu на свой компьютер:

docker pull ubuntu

========================================================

Чтобы просмотреть образы, которые были загружены на ваш компьютер, введите:

docker images

=========================================

В качестве примера мы запустим контейнер с самым последним образом образ Ubuntu. Сочетание переключателей -i и -t предоставляет вам доступ к интерактивной командной оболочке внутри контейнера:

docker run -it ubuntu

=================================================

Необходимо изменить приглашение к вводу команды, чтобы отразить тот факт, что вы работаете внутри контейнера, и должны иметь следующую форму:

Output
root@d9b100f2f636:/#
Обратите внимание на идентификатор контейнер в запросе команды. В данном примере это d9b100f2f636. Вам потребуется этот идентификатор для определения контейнера, когда вы захотите его удалить.

===================================================

Теперь вы можете запустить любую команду внутри контейнера. Например, сейчас мы обновим базу данных пакетов внутри контейнера. Вам не потребуется начинать любую команду с sudo, потому что вы работаете внутри контейнера как root-пользователь:

apt update
 
После этого вы можете установите любое приложение внутри контейнера. Давайте установим Node.js:

apt install nodejs
 
Эта команда устанавливает Node.js внутри контейнера из официального репозитория Ubuntu. После завершения установки проверьте, что Node.js был установлен успешно:

node -v
 
Вы увидите номер версии, отображаемый в терминале:

Output
v10.19.0
Любые изменения, которые вы вносите внутри контейнера, применяются только к контейнеру.

Чтобы выйти из контейнера, введите exit.

=========================================================
busybox запускает контейнер с 'sh'

docker container run busybox

docker image pull nginx (устанавливаем образ nginx )

docker container ls -a ( флаг -a список всех контейнеров, включая те, что были остановлены)

docker container run -P -d nginx ( -P произвольный порт, -d запускаем в фоновом режиме)

docker container ps (все работаюие контейнеры)

docker container inspect idContainer

Подключаемся к контейнеру:

docker container attach 7d20d6eec24f (попадаем в журнал доступа, после выхода контейнер останавливается)

Запускаем контейнер

docker container start 7d20d6eec24f

Останавливаем:

docker container start 7d20d6eec24f

Генерим траффик

curl localhost:49154

Проверяем логи:

docker container logs 7d20d6eec24f

Использование ресурсов:

docker container stats 7d20d6eec24f

Заходим в оболочку контейнера

docker container exec -it 7d20d6eec24f /bin/bash

Ставим на паузу контейнер ( приостанавливают работу все процессы)

docker container pause 7d20d6eec24f

Снимаем с паузы:

docker container unpause 7d20d6eec24f

Удаляем контейнер:

docker container rm -f 7d20d6eec24f

Удаляем все остановленные контейнеры:

docker container prune -f (-f принудительно, не спрашивая )
=================================

Создание контейнеров

docker container run busybox (запускает и сразу останавливается процесс, sh, удлбно для задач)

docker container run --rm busybox (флаг --rm после завершения задачи, контейнер останавливается и удаляется)

docker container run nginx

docker container run -d nginx (создаем контейнер (-d выйти из контейнера) и запустить в фоновом режиме)

Присоединяемся к созданному контейнеру

docker container run -it busybox

Создаем свой контейнер

docker container run --name my_busybox busybox

=================================================

Открытие портов контейнеров

docker container run -d --expose 1234 nginx (открываем порт 1234)

docker rm -f 2581f9e320fb e966ef48fa52 (удаляем ненужные контейнеры, например с nginx)

docker container run -d --expose 1234 -p 80:1234 nginx (перенаправляем порт с 80 на 1234)

docker container run -d --expose 1234 -p 8080:80 nginx (перенаправляем порт с 8080 на 80)

docker container run -d -p 8081:80/tcp -p 8081:80/udp nginx 

docker container port id (смотрим порты открытые/перенаправленные на определенном контейнере)

================================================

Выполнение команд в контейнере


docker container run -d nginx

Заходим в командную строку nginx

docker container run -it nginx /bin/bash (после выхода контенейнер перестает существовать)

docker container exec -it 7d20d6eec24f /bin/bash (после выхода контейнер по прежнему работает и существует)

exec можно выполнять команды на работающем контейнере и не заходить на него

docker container exec -it 7d20d6eec24f ls /etc/var

===============================================
